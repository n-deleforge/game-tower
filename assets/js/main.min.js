function launcher(){get("#startScreen").style.display="flex",get("#displayTip").innerHTML=_CONTENT.tips[rand(0,_CONTENT.tips.length)],null!=GAME.core.name&&""!=GAME.core.name?get("#nameHero").value=GAME.core.name:(get("#nameHero").value="",get("#nameHero").focus()),get("#startGame").addEventListener("click",function(){get("#nameHero").checkValidity()&&""!=get("#nameHero").value?startGame("new"):(get("#nameHeroLabel").innerHTML=_CONTENT.events.nameHeroCheck,get("#nameHeroLabel").style.color=getVariableCSS("errorTextColor"))})}function startGame(e){get("#startScreen").style.display="none",get("#gameScreen").style.display="flex",changeDisplay("actionGameMode"),createMenu(),createButtons(),checkVersion(),REFRESH_DISPLAY=setInterval(displayGame,100),"new"==e?(GAME.core.name=get("#nameHero").value,GAME.core.ongoing=!0,playSound("Room"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.start+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.startGame_part1+".</p>",get("#gameContent").innerHTML+="<em>"+_CONTENT.events.startGame_part2+".</em>",get("#gameContent").innerHTML+="<p>"+_CONTENT.events.startGame_part3+".</p>"):"load"==e&&("fight"==GAME.events.lastAction&&"fightOver"!=GAME.events.subAction&&changeDisplay("actionGameToFight"),"chest"==GAME.events.lastAction&&"chestOver"!=GAME.events.subAction&&changeDisplay("actionGameToChest"),get("#gameContent").innerHTML=GAME.events.currentEvent)}function playTurn(){GAME.events.subAction=null,GAME.character.room++,changeDisplay("screenDisplayMessage"),GAME.character.room>10?(INTERVAL_REFRESH=2e3,GAME.character.room=1,GAME.character.floor++,playSound("Floor"),get("#gameMessage").innerHTML='<p class="bigger">'+_CONTENT.vocabulary.floor+" "+GAME.character.floor+"</p>"):(INTERVAL_REFRESH=1e3,GAME.stats.totalRoom++,playSound("Room"),get("#gameMessage").innerHTML='<p class="bigger">'+_CONTENT.vocabulary.floor+" "+parseInt(GAME.character.floor)+"</p>",get("#gameMessage").innerHTML+="<p>"+_CONTENT.vocabulary.room+" "+GAME.character.room+"</p>"),setTimeout(function(){changeDisplay("screenHideMessage")},INTERVAL_REFRESH),choiceAction()}function choiceAction(){let e=rand(1,9);e>7?(GAME.events.newAction="spirit",GAME.events.newAction!=GAME.events.lastAction?spirit():choiceAction()):e>4?(GAME.events.newAction="fight",GAME.events.newAction!=GAME.events.lastAction?fight():choiceAction()):e>2?(GAME.events.newAction="chest",GAME.events.newAction!=GAME.events.lastAction?chest():choiceAction()):(GAME.events.newAction="noEvent",GAME.events.newAction!=GAME.events.lastAction?noEvent():choiceAction())}function heal(){GAME.character.itemHeal>0&&GAME.character.health<GAME.character.healthMax?(GAME.character.itemHeal--,GAME.character.health=GAME.character.healthMax,GAME.stats.healUsed++,playVibrate(10),playSound("Heal"),get("#gameContent").innerHTML+='<hr><p class="green">'+_CONTENT.events.healing+"</p>"):playVibrate(250)}function noEvent(){GAME.events.lastAction="noEvent",get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.noEvent+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.noEvent+".</p>"}function spirit(){GAME.events.lastAction="spirit",GAME.stats.spiritMeet++;let e=rand(1,8);if(e>6)GAME.character.shield=GAME.character.shield+_SETTINGS.data.spiritShield,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.earthSpirit+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.spiritEarth_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.events.spiritEarth_part2+" <strong>"+_SETTINGS.data.spiritShield+"</strong> "+plural(_SETTINGS.data.spiritShield,_CONTENT.vocabulary.point_singular,_CONTENT.vocabulary.point_plural)+".</p>";else if(e>4){const e=rand(parseInt(GAME.character.xpTo/8),parseInt(GAME.character.xpTo/6));GAME.character.xp=GAME.character.xp+e,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.lightSpirit+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.spiritLight_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.events.spiritLight_part2+"<strong>"+e+"</strong> "+plural(e,_CONTENT.vocabulary.point_singular,_CONTENT.vocabulary.point_plural)+_CONTENT.events.spiritLight_part3+".</p>"}else e>2?(GAME.character.strength=GAME.character.strength+_SETTINGS.data.spiritStrength,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.fireSpirit+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.spiritFire_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.events.spiritFire_part2+" <strong>"+_SETTINGS.data.spiritStrength+"</strong> "+plural(_SETTINGS.data.spiritStrength,_CONTENT.vocabulary.point_singular,_CONTENT.vocabulary.point_plural)+".</p>"):(GAME.character.healthMax=GAME.character.healthMax+_SETTINGS.data.spiritHealth,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.waterSpirit+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.spiritWater_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.events.spiritWater_part2+" <strong>"+_SETTINGS.data.spiritHealth+"</strong> "+plural(_SETTINGS.data.spiritHealth,_CONTENT.vocabulary.point_singular,_CONTENT.vocabulary.point_plural)+".</p>")}function chest(){GAME.events.lastAction="chest",changeDisplay("actionGameToChest"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chest+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.chest+" !</p>"}function openChest(){GAME.events.subAction="chestOver",GAME.stats.chestOpen++,playVibrate(90),playSound("Chest"),changeDisplay("actionChestToGame");const e=rand(0,10);let t=!1;if(e>6){GAME.stats.chestTrap++;const e=rand(1,GAME.character.health/4);GAME.character.health=GAME.character.health-e,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chestTrap+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.chestTrap_part1+" !</p>",get("#gameContent").innerHTML+='<p class="red">'+_CONTENT.events.chestTrap_part2+"<strong>"+e+"</strong> "+plural(e,_CONTENT.vocabulary.point_singular,_CONTENT.vocabulary.point_plural)+_CONTENT.events.chestTrap_part3+".</p>"}else e>3?(_SETTINGS.data.itemLimit>GAME.character.itemMagic?GAME.character.itemMagic++:t=!0,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chestMagic+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.chestMagic+".</p>",t&&(get("#gameContent").innerHTML+="<p>"+_CONTENT.events.chestLimit+".</p>")):(_SETTINGS.data.itemLimit>GAME.character.itemHeal?GAME.character.itemHeal++:t=!0,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chestHeal+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.chestHeal+".</p>",t&&(get("#gameContent").innerHTML+="<p>"+_CONTENT.events.chestLimit+".</p>"))}function closeChest(){GAME.events.subAction="chestOver",GAME.stats.chestNotOpened++,playVibrate(10),changeDisplay("actionChestToGame"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chest+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.chest+" !</p>",get("#gameContent").innerHTML+="<p>"+_CONTENT.events.chest_notOpened+".</p>"}function fight(){GAME.events.lastAction="fight",GAME.events.monster=choiceMonster(),changeDisplay("actionGameToFight"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+GAME.events.monster[3]+'" alt="'+GAME.events.monster[2]+'"></div>',get("#gameContent").innerHTML+="<p><strong>"+GAME.events.monster[2]+"</strong> "+_CONTENT.events.fightStart+"</p>",get("#gameContent").innerHTML+="<p>"+_CONTENT.vocabulary.health+" : <strong>"+GAME.events.monster[0]+"</strong> / "+_CONTENT.vocabulary.strength+" : <strong>"+GAME.events.monster[1]+"</strong></p>"}function choiceMonster(){const e=rand(3*GAME.character.floor,6*GAME.character.floor);let t=rand(parseInt(e/5),parseInt(e/3));return 0==t&&(t=1),e>500?[e,t,_CONTENT.monsters.dragon,_SETTINGS.images.monster17]:e>450?[e,t,_CONTENT.monsters.supDemon,_SETTINGS.images.monster16]:e>400?[e,t,_CONTENT.monsters.bigSpirit,_SETTINGS.images.monster15]:e>350?[e,t,_CONTENT.monsters.deadWarrior,_SETTINGS.images.monster14]:e>290?[e,t,_CONTENT.monsters.troll,_SETTINGS.images.monster13]:e>240?[e,t,_CONTENT.monsters.behemot,_SETTINGS.images.monster12]:e>190?[e,t,_CONTENT.monsters.minotaur,_SETTINGS.images.monster11]:e>160?[e,t,_CONTENT.monsters.cerberus,_SETTINGS.images.monster10]:e>130?[e,t,_CONTENT.monsters.goblin,_SETTINGS.images.monster09]:e>100?[e,t,_CONTENT.monsters.ghost,_SETTINGS.images.monster08]:e>75?[e,t,_CONTENT.monsters.cockatrice,_SETTINGS.images.monster07]:e>50?[e,t,_CONTENT.monsters.lamia,_SETTINGS.images.monster06]:e>40?[e,t,_CONTENT.monsters.imp,_SETTINGS.images.monster05]:e>30?[e,t,_CONTENT.monsters.plant,_SETTINGS.images.monster04]:e>20?[e,t,_CONTENT.monsters.scorpio,_SETTINGS.images.monster03]:e>10?[e,t,_CONTENT.monsters.spider,_SETTINGS.images.monster02]:[e,t,_CONTENT.monsters.slim,_SETTINGS.images.monster01]}function attack(){GAME.events.subAction="fightOver",GAME.stats.fightVictory++,playVibrate(10),playSound("Attack"),changeDisplay("actionFightToGame");const e=Math.ceil(GAME.events.monster[0]/GAME.character.strength);let t=parseInt(e*GAME.events.monster[1])-GAME.character.shield;1==e&&(t=0),t<0&&(t=0),GAME.character.health=GAME.character.health-t;const a=rand(parseInt(GAME.character.xpTo/8),parseInt(GAME.character.xpTo/6));GAME.character.xp=GAME.character.xp+a,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+GAME.events.monster[3]+'" alt="'+GAME.events.monster[2]+'"></div>',get("#gameContent").innerHTML+="<p><strong>"+GAME.events.monster[2]+"</strong> "+_CONTENT.events.fightWin_part1+"<strong>"+e+"</strong> "+plural(e,_CONTENT.vocabulary.hit_singular,_CONTENT.vocabulary.hit_plural)+" !</p>",get("#gameContent").innerHTML+='<p class="red">'+_CONTENT.events.fightWin_part2+"<strong>"+t+"</strong> "+plural(t,_CONTENT.vocabulary.point_singular,_CONTENT.vocabulary.point_plural)+" "+_CONTENT.events.fightWin_part3+".</p>",GAME.character.health>0&&(get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.events.fightWin_part5+"<strong>"+a+"</strong> "+plural(a,_CONTENT.vocabulary.point_singular,_CONTENT.vocabulary.point_plural)+_CONTENT.events.fightWin_part4+".</p>")}function magic(){if(GAME.character.itemMagic>0){GAME.events.subAction="fightOver",GAME.character.itemMagic--,GAME.stats.fightVictory++,playVibrate(10),playSound("Magic"),changeDisplay("actionFightToGame");const e=parseInt(GAME.character.xpTo/8);GAME.character.xp=GAME.character.xp+e,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+GAME.events.monster[3]+'" alt="'+GAME.events.monster[2]+'"></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.events.fightMagic+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.events.fightWin_part5+"<strong>"+e+"</strong> "+plural(e,_CONTENT.vocabulary.point_singular,_CONTENT.vocabulary.point_plural)+_CONTENT.events.fightWin_part4+".</p>"}else playVibrate(250)}function displayGame(){GAME.character.health<1?gameOver():(checkExperience(),checkInfo(),checkItems(),checkScore(),""!=get("#gameContent").innerHTML&&(GAME.events.currentEvent=get("#gameContent").innerHTML),setStorage("TOWER-save",JSON.stringify(GAME)))}function gameOver(){clearInterval(REFRESH_DISPLAY),playVibrate(500),changeDisplay("actionGameMode"),get(".listActionsLine")[0].innerHTML='<button id="gameover">'+_CONTENT.events.results,get("#gameover").addEventListener("click",displayScore),get("#gameContent").innerHTML+='<p class="red"><strong>'+_CONTENT.events.death+"</strong></p>"}function displayScore(){changeDisplay("screenDisplayMessage"),get("#gameMessage").style.backgroundColor=getVariableCSS("gameoverBackground"),get("#gameMessage").innerHTML="<p>"+_CONTENT.events.gameover_part1+GAME.character.floor+".</p>",get("#gameMessage").innerHTML+='<p class="bigger">'+_CONTENT.events.gameover_part2+GAME.character.score+"</p>",get("#gameMessage").innerHTML+='<button id="restart">'+_CONTENT.events.gameoverButton+"</button>",get("#restart").addEventListener("click",()=>{location.reload()}),resetGame()}function changeDisplay(e){"actionGameMode"==e&&(get(".listActionsLine")[1].style.display="none",get(".listActionsLine")[2].style.display="none"),"actionGameToChest"==e&&(get(".listActionsLine")[0].style.display="none",get(".listActionsLine")[1].style.display="flex"),"actionChestToGame"==e&&(get(".listActionsLine")[0].style.display="flex",get(".listActionsLine")[1].style.display="none"),"actionGameToFight"==e&&(get(".listActionsLine")[0].style.display="none",get(".listActionsLine")[2].style.display="flex"),"actionFightToGame"==e&&(get(".listActionsLine")[0].style.display="flex",get(".listActionsLine")[2].style.display="none"),"screenDisplayMessage"==e&&(get("~header").style.display="none",get("#gameScreen").style.display="none",get("#gameMessage").style.display="flex"),"screenHideMessage"==e&&(get("~header").style.display="flex",get("#gameScreen").style.display="flex",get("#gameMessage").style.display="none")}function checkInfo(){get("#headerTitle").innerHTML=_CONTENT.vocabulary.floor+" "+GAME.character.floor+" - "+_CONTENT.vocabulary.room+" "+GAME.character.room,get("#health").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconHealth+'" alt=""> '+GAME.character.health+" / "+GAME.character.healthMax,get("#xp").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconExperience+'" alt=""> '+GAME.character.xp+" / "+GAME.character.xpTo+" ("+GAME.character.level+")",get("#strength").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconStrength+'" alt="">  '+GAME.character.strength,get("#shield").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconShield+'" alt="">  '+GAME.character.shield}function checkItems(){get("#useHeal").style.opacity=GAME.character.itemHeal<1||GAME.character.health==GAME.character.healthMax?.5:1,get("#useMagic").style.opacity=GAME.character.itemMagic>0?1:.5,get("#potion").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconPotion+'" alt=""> '+GAME.character.itemHeal,get("#magic").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconMagic+'" alt=""> '+GAME.character.itemMagic}function checkExperience(){GAME.character.xp>=GAME.character.xpTo&&(GAME.character.level++,GAME.character.strength=GAME.character.strength+_SETTINGS.data.lvlUpStrength,GAME.character.shield=GAME.character.shield+_SETTINGS.data.lvlUpShield,GAME.character.healthMax=GAME.character.healthMax+_SETTINGS.data.lvlUpHealth,GAME.character.health=GAME.character.healthMax,GAME.character.xp=0,GAME.character.xpTo=rand(parseInt(1.5*GAME.character.xpTo),2*GAME.character.xpTo),get("#gameContent").innerHTML+='<hr><p class="green"><strong>'+_CONTENT.events.levelUp_part1+"</strong>.</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.events.levelUp_part2+".</p>")}function checkScore(){GAME.character.score=(GAME.character.strength+GAME.character.healthMax)*GAME.character.level*GAME.character.floor-30,GAME.character.score>GAME.stats.bestScore&&(GAME.stats.bestScore=GAME.character.score),GAME.character.floor>GAME.stats.bestFloor&&(GAME.stats.bestFloor=GAME.character.floor),GAME.character.level>GAME.stats.maxLevel&&(GAME.stats.maxLevel=GAME.character.level)}function checkSound(){1==GAME.core.sound?(GAME.core.sound=!1,get("#volumeButton").innerHTML="🔈"):(GAME.core.sound=!0,get("#volumeButton").innerHTML="🔊")}function checkVibrate(){1==GAME.core.vibrate?(GAME.core.vibrate=!1,get("#vibrateButton").innerHTML="📴"):(GAME.core.vibrate=!0,get("#vibrateButton").innerHTML="📳")}function checkStats(){let e=Object.values(_CONTENT.stats),t=Object.values(GAME.stats);for(let a=0;a<e.length;a++)0==a?get("#listStats").innerHTML="<li>"+e[a]+t[a]+"</li>":get("#listStats").innerHTML+="<li>"+e[a]+t[a]+"</li>"}function checkVersion(){GAME.core.version!=_VERSION&&(GAME.core.version=_VERSION),setStorage("TOWER-save",JSON.stringify(GAME))}function createMenu(){get("#openMenu").addEventListener("click",()=>{get("#blankMenu").style.display="block",get("#menu").style.display="block",get("#closeMenu").style.visibility="visible",checkStats()}),get("#closeMenu").addEventListener("click",()=>{get("#blankMenu").style.display="none",get("#menu").style.display="none",get("#closeMenu").style.visibility="hidden"}),get("#confirmRestart").addEventListener("click",()=>{get("#blankPopup").style.display="block",get("#popup").style.display="flex",get("#popupText").innerHTML=_CONTENT.main.popupRestart,get("#popupCancel").addEventListener("click",()=>{get("#blankPopup").style.display="none",get("#popup").style.display="none"}),get("#popupAccept").addEventListener("click",()=>{clearInterval(REFRESH_DISPLAY),GAME.core.ongoing=!1,resetGame(),location.reload()})}),get("#confirmDelete").addEventListener("click",()=>{get("#blankPopup").style.display="block",get("#popup").style.display="flex",get("#popupText").innerHTML=_CONTENT.main.popupDelete,get("#popupCancel").addEventListener("click",()=>{get("#blankPopup").style.display="none",get("#popup").style.display="none"}),get("#popupAccept").addEventListener("click",()=>{clearInterval(REFRESH_DISPLAY),remStorage("TOWER-save"),location.reload()})})}function createButtons(){get("#openMenu").style.visibility="visible",get("#volumeButton").addEventListener("click",checkSound),get("#vibrateButton").addEventListener("click",checkVibrate),1==GAME.core.sound?get("#volumeButton").innerHTML="🔊":get("#volumeButton").innerHTML="🔈",1==GAME.core.vibrate?get("#vibrateButton").innerHTML="📳":get("#vibrateButton").innerHTML="📴",get("#useHeal").addEventListener("click",heal),get("#openChest").addEventListener("click",openChest),get("#closeChest").addEventListener("click",closeChest),get("#useAttack").addEventListener("click",attack),get("#useMagic").addEventListener("click",magic),get("#move").addEventListener("click",()=>{playVibrate(50),playTurn()})}function playSound(e){1==GAME.core.sound&&get("#sound"+e).play()}function playVibrate(e){1==GAME.core.vibrate&&navigator.vibrate(e)}function resetGame(){GAME.core.ongoing=!1,GAME.stats.totalGame++,GAME.character.health=_SETTINGS.data.health,GAME.character.healthMax=_SETTINGS.data.healthMax,GAME.character.strength=_SETTINGS.data.strength,GAME.character.shield=_SETTINGS.data.shield,GAME.character.xp=_SETTINGS.data.xp,GAME.character.xpTo=_SETTINGS.data.xpTo,GAME.character.itemHeal=_SETTINGS.data.itemHeal,GAME.character.itemMagic=_SETTINGS.data.itemMagic,GAME.character.level=_SETTINGS.data.level,GAME.character.floor=_SETTINGS.data.floor,GAME.character.room=_SETTINGS.data.room,setStorage("TOWER-save",JSON.stringify(GAME))}0==GAME.core.ongoing?launcher():startGame("load");