let settings={version:1.4,basicStats:{health:25,healthMax:25,strength:5,shield:0,xp:0,xpTo:50,level:1,floor:1,room:1,heal:0,magic:0,escape:0,score:0,itemLimit:5,lvlHealth:20,lvlStrength:2,lvlShield:0},bonusSpirit:{health:5,strength:1,shield:1},refreshDisplay:null,mobileDevice:/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),messageDisplay:1e3};if(settings.mobileDevice&&(get("#container").style.minHeight=window.outerHeight+"px"),storage("get","TOWER-gameSettings"))var game=JSON.parse(storage("get","TOWER-gameSettings"));else{game={core:{ongoing:!1,name:null,sound:!0,version:1.3},events:{lastAction:null,newAction:null,subAction:null,monster:null,currentEvent:null},stats:{bestScore:0,totalGame:0,bestFloor:0,totalRoom:0,maxLevel:0,totalExp:0,healUsed:0,swordKill:0,magicKill:0,runAway:0,healFound:0,magicFound:0,escapeFound:0,chestTrap:0,chestNotOpened:0,fireSpiritMeet:0,waterSpiritMeet:0,earthSpiritMeet:0,windSpiritMeet:0,lighSpiritMeet:0},character:{health:settings.basicStats.health,healthMax:settings.basicStats.healthMax,strength:settings.basicStats.strength,shield:settings.basicStats.shield,xp:settings.basicStats.xp,xpTo:settings.basicStats.xpTo,level:settings.basicStats.level,floor:settings.basicStats.floor,room:settings.basicStats.room,heal:settings.basicStats.heal,magic:settings.basicStats.magic,escape:settings.basicStats.escape,score:settings.basicStats.score,itemLimit:settings.basicStats.itemLimit},bonus:{lvlHealth:settings.basicStats.lvlHealth,lvlStrength:settings.basicStats.lvlStrength,lvlShield:settings.basicStats.lvlShield}};storage("set","TOWER-gameSettings",JSON.stringify(game))}const FR={auto:{title:"La Tour",headerTitle:"La Tour",startScreenTitle:"Bienvenue aventurier",nameHeroLabel:"Quel est ton nom ?",startGame:"Entrer",footer:'Disponible sur <a href="https://github.com/n-deleforge/game-tower">GitHub</a> (v '+settings.version+')<br />Hébergé sur <a href="https://nicolas-deleforge.fr">nd</a>',move:"Avancer",useHeal:"Utiliser une potion",openChest:"Ouvrir le coffre",closeChest:"Ne pas l'ouvrir",useAttack:"Attaque",useMagic:"Sortilège",useEscape:"Fuite",optionMenuTitle:"Paramètres",statsMenuTitle:"Statistiques",closeStatsMenu:"Fermer",openStatsMenu:"Statistiques",closeOptionMenu:"Fermer",confirmRestart:"Recommencer la partie",confirmTotalRestart:"⚠ EFFACER les données",openInfoMenu:"Plus d'informations",closeInfoMenu:"Fermer",infoMenuTitle:"Plus d'informations",infoMenuContent:"<li>L'application a été réalisée uniquement en Javascript pure, sans aucune librairies externes.</li>\n                                         <li>La majorité des ressources (images et sons) proviennent de la librairie de base de RPG Maker MV que je possède. Les icones de statut proviennent d'un pack gratuit sur <a href=\"https://kyrise.itch.io/kyrises-free-16x16-rpg-icon-pack\">Itchio</a>.</li>"},stats:{bestScore:"Meilleur score : ",totalGame:"Nombre de parties : ",bestFloor:"Étage atteint le plus haut : ",totalRoom:"Nombre de salle parcourue : ",maxLevel:"Niveau d'expérience le plus haut : ",totalExp:"Total de points d'expérience : ",healUsed:"Nombre de potion utilisé : ",swordKill:"Monstre vaincu avec une épée : ",magicKill:"Monstre vaincu avec la magie : ",runAway:"Fuite de combat : ",healFound:"Coffre - potions trouvée : ",magicFound:"Coffre - sortilège trouvé : ",escapeFound:"Coffre - parchemin trouvé : ",chestTrap:"Coffre - piège : ",chestNotOpened:"Coffre - non ouverts : ",fireSpiritMeet:"Esprit rencontré - feu : ",waterSpiritMeet:"Esprit rencontré - eau : ",earthSpiritMeet:"Esprit rencontré - terre : ",windSpiritMeet:"Esprit rencontré - vent : ",lighSpiritMeet:"Esprit rencontré - lumière : "},app:{nameHeroCheck:"Votre nom doit être composé de 2 à 15 lettres",health:"Santé",experience:"Exp.",level:"niv.",score:"Score",strength:"Force",shield:"Bouclier",floor:"Étage",room:"Salle",heal_singular:"Potion",heal_plural:"Potions",magic_singular:"Sort",magic_plural:"Sorts",escape_singular:"Parchemin",escape_plural:"Parchemins",point_singular:"point",point_plural:"points",hit_singular:"coup",hit_plural:"coups",levelUp_part1:"Votre niveau augmente",levelUp_part2:"Votre santé est regénérée et vos statistiques augmentent",healing:"Vous avez utilisé une potion, vous regagnez toute votre santé",noEvent:"Vous traversez tranquillement de longs couloirs",spiritEarth_part1:"Un <strong>esprit de la terre</strong> vous protège",spiritEarth_part2:"Votre bouclier augmente de ",spiritWind:"Un <strong>esprit du vent</strong> virevolte autour de vous",spiritWind_noStealing:"Et s'enfuit",spiritWind_healStealing:"Il dérobe une <strong>potion de soin</strong>",spiritWind_magicStealing:"Il dérobe un <strong>sort magique</strong>",spiritWind_escapeStealing:"Il dérobe un <strong>parchemin de fuite</strong>",spiritLight_part1:"Un <strong>esprit de lumière</strong> se rapproche de vous",spiritLight_part2:"Vous gagnez ",spiritLight_part3:" d'expérience",spiritFire_part1:"Un <strong>esprit de feu</strong> partage son énergie",spiritFire_part2:"Votre force augmente de ",spiritWater_part1:"Un <strong>esprit d'eau</strong> partage sa vitalité",spiritWater_part2:"Votre santé augmente de ",chest:"Vous avez trouvé un <strong>coffre</strong>",chest_notOpened:"Mais vous décidez de ne pas l'ouvrir",chestTrap_part1:"Mais c'est un piège, le coffre vous attaque",chestTrap_part2:"Vous perdez ",chestTrap_part3:" de santé",chestEscape:"Vous trouvez un <strong>parchemin de fuite</strong>",chestMagic:"Vous trouvez un <strong>sort magique</strong>",chestHeal:"Vous trouvez une <strong>potion de soin</strong>",chestLimit:"Mais vous n'avez plus assez de place",fightStart:"apparaît !",fightWin_part1:" vaincu en ",fightWin_part2:"Vous avez perdu ",fightWin_part3:" de santé",fightWin_part4:" d'expérience",fightWin_part5:"Vous avez gagné ",fightMagic:"Vous avez vaincu le monstre grâce à un sort magique",fightEscape:"Vous vous échappez grâce au parchemin de fuite",bossFight_start:"Un adversaire puissant vous barre la route",bossFight_win:"L'adversaire puissant vaincu en ",bossFight_magic:"Vous avez vaincu l'adversaire puissant grâce à un sort magique",death:"Vous tombez de fatigue ...",results:"Voir les résultats",gameover:"La partie est terminée.<br />Vous avez obtenu un score de : ",gameoverButton:"Recommencer",shareScore_part1:"Wahou! Je viens de faire un score de ",shareScore_part2:" points dans La Tour !",shareScore_button:"Partager",initialContent:'<div id="containerImage"><img src="assets/images/special/sign.png" alt=""></div>\n                                    <p>Une vieille pancarte. La plupart des mots sont effacés par le temps.</p>\n                                    <em>"Celui qui ... le sommet pourra ... l\'un de ses ... ! ... le danger, restez en ... et grimpez le ... haut ..."</em>\n                                    <p>Vous continuez votre chemin d\'un pas déterminé.</p>'},monsters:{dragon:"Dragon légendaire",supDemon:"Démon supérieur",bigSpirit:"Esprit errant",deadWarrior:"Guerrier mort-vivant",troll:"Chef-troll",behemot:"Béhémot",minotaur:"Minotaure",cerberus:"Cerbère",goblin:"Gobelin",ghost:"Fantôme",cockatrice:"Basilic",lamia:"Lamia",imp:"Diablotin",plant:"Plante venimeuse",scorpio:"Grand scorpion",spider:"Araignée géante",slim:"Blob"},tips:["Lorsque la santé du héros tombe à 0, la partie est terminée. Cependant, un gain de niveau ou une potion restaure la totalité des points de santé.",'Chaque monstre nécessite un nombre de coups pour être vaincu qui est calculé de la manière suivante : <em>"santé du monstre divisé par la force du héros"</em>','Les dégâts d\'un monstre sont calculés selon la formule suivante : <em>"(nombre de coups pour être vaincu multiplié par la force du monstre) moins le bouclier du héros"</em>',"Vaincre un monstre avec un sort rapporte seulement 50% de points d'expérience mais peut éviter une morte certaine ou de très gros dégâts.","Les combats se déroulent automatiquement alors veillez à bien choisir votre action de jeu. La fuite peut être une bonne solution pour rester en vie.","La statistique de bouclier permet de réduire les dégâts lors d'une attaque dans un combat. Elle peut être uniquement augmentée par l'esprit de la terre.","La Tour est peuplée de divers esprits. La plupart d'entre eux vous aideront grandement lors de votre quête, néanmoins certains peuvent être aggressifs.","Lorsque vous ouvrez un coffre, vous avez une chance de tomber sur un monstre qui vous infligera des dégâts qui ignorent votre statistique de bouclier.","La Tour est divisé par étages. Chaque étage est lui-même composé de 10 salles. A chaque étage, les monstres deviennent plus puissants.",'Pour les plus curieux, le score de fin de partie est calculé selon la formule suivante : <em>"((bouclier + force + santé maximale) * niveau) * étage"</em>',"Un combat contre un adversaire puissant est plus compliqué. Vous ne pouvez pas fuir et il est nécessaire de posséder au moins 3 sorts pour gagner grâce au sortillège.","En début de partie, chaque objet que vous pouvez récupérer est limité à une certaine quantité. Par la suite, vous pourrez en garder devantage. "]},EN={auto:{title:"The Tower",headerTitle:"The Tower",startScreenTitle:"Welcome adventurer",nameHeroLabel:"What's your name ?",startGame:"Enter",footer:'Soon available on <a href="https://github.com/n-deleforge/game-tower">GitHub</a> (v '+settings.version+')<br />Hosted on <a href="https://nicolas-deleforge.fr">nd</a>',move:"Move",useHeal:"Use a potion",openChest:"Open the chest",closeChest:"Do not open",useAttack:"Attack",useMagic:"Spell",useEscape:"Escape",optionMenuTitle:"Settings",statsMenuTitle:"Statistics",closeStatsMenu:"Close",openStatsMenu:"Statistics",closeOptionMenu:"Close",confirmRestart:"Restart the game",confirmTotalRestart:"⚠ DELETE all data",openInfoMenu:"More informations",closeInfoMenu:"Close",infoMenuTitle:"More informations",infoMenuContent:'<li>The application has been realized only with pure Javascript, no external libraries has been used.</li>\n                                         <li>The majority of the resources (images and sounds) are from the basic library of RPG Maker MV that I own. The icons of the top bar are from a free pack on <a href="https://kyrise.itch.io/kyrises-free-16x16-rpg-icon-pack">Itchio</a>.</li>'},stats:{bestScore:"Best score : ",totalGame:"Number of games : ",bestFloor:"Highest floor : ",totalRoom:"Number of rooms : ",maxLevel:"Highest exp. level : ",totalExp:"Total exp. point : ",healUsed:"Potion used : ",swordKill:"Monsters defeated with a sword : ",magicKill:"Monsters defeated with magic  : ",runAway:"Fight escaped: ",healFound:"Chest - potion found : ",magicFound:"Chest - spell found : ",escapeFound:"Chest - scroll found : ",chestTrap:"Chest - trap : ",chestNotOpened:"Chest - not opened : ",fireSpiritMeet:"Spirit meet - fire : ",waterSpiritMeet:"Spirit meet - water : ",earthSpiritMeet:"Spirit meet - earth : ",windSpiritMeet:"Spirit meet - wind : ",lighSpiritMeet:"Spirit meet - light : "},app:{nameHeroCheck:"Your name must be composed between 2 to 15 letters.",health:"Health",experience:"Exp.",level:"lvl",score:"Score",strength:"Strength",shield:"Shield",floor:"Floor",room:"Room",heal_singular:"Potion",heal_plural:"Potions",magic_singular:"Spell",magic_plural:"Spells",escape_singular:"Scroll",escape_plural:"Scrolls",point_singular:"point",point_plural:"points",hit_singular:"hit",hit_plural:"hits",levelUp_part1:"Level up",levelUp_part2:"Your health is regenerated and your stats increase",healing:"You use a potion, you regain all your health",noEvent:"You walk quietly through long corridors",spiritEarth_part1:"A <strong>earth spirit</strong> protects you",spiritEarth_part2:"Your shield increases by ",spiritWind:"A <strong>wind spirit</strong> flies around you",spiritWind_noStealing:"And fled",spiritWind_healStealing:"He steals a <strong>healing potion</strong>",spiritWind_magicStealing:"He steals a <strong>magic spell</strong>",spiritWind_escapeStealing:"He steals a <strong>escape scroll</strong>",spiritLight_part1:"A <strong>light spirit</strong> draws near to you",spiritLight_part2:"You win ",spiritLight_part3:" of experience",spiritFire_part1:"A <strong>fire spirit</strong> shares its energy",spiritFire_part2:"Your strength increases by ",spiritWater_part1:"A <strong>water spirit</strong> shares its vitality",spiritWater_part2:"Your health increases by ",chest:"You have found a <strong>chest</strong>",chest_notOpened:"But you decide not to open it",chestTrap_part1:"But it's a trap, the chest attacks you",chestTrap_part2:"You lost ",chestTrap_part3:" of health",chestEscape:"You find a <strong>escape scroll</strong>",chestMagic:"You find a <strong>magic spell</strong>",chestHeal:"You find a <strong>healing potion</strong>",chestLimit:"But you don't have enough room",fightStart:"appears !",fightWin_part1:" defeated with ",fightWin_part2:"You have lost ",fightWin_part3:" of health",fightWin_part4:" of experience",fightWin_part5:"You have won ",fightMagic:"You have defeated the monster with a magic spell",fightEscape:"You escape thanks to the escape scroll",bossFight_start:"A powerful opponent stands in your way",bossFight_win:"The mighty opponent defeated in ",bossFight_magic:"You defeated the mighty opponent with a magic spell",death:"You're very tired ...",results:"See the results",gameover:"The game is over.<br />You got a score of: ",gameoverButton:"Restart",shareScore_part1:"Wow! I just made a score of ",shareScore_part2:" points in The Tower!",shareScore_button:"Share",initialContent:'<div id ="containerImage"><img src="assets/images/special/sign.png" alt =""></div>\n                                <p>An old sign. Most of the words are erased by time.</p>\n                                <em>"Whoever ... the top may ... one of its ...! ... danger, stay in ... and climb the ... top ..."</em>\n                                <p>You continue your journey with a determined step.</p> '},monsters:{dragon:"Legendary dragon",supDemon:"Superior demon",bigSpirit:"Wandering spirit",deadWarrior:"Undead warrior",troll:"Chief troll",behemot:"Behemot",minotaur:"Minotaur",cerberus:"Cerberus",goblin:"Goblin",ghost:"Ghost",cockatrice:"Cockatrice",lamia:"Lamia",imp:"Imp",plant:"Poisonous plant",scorpio:"Big scorpion",spider:"Giant spider",slim:"Blob"},tips:["When the hero's health drops to 0, the game is over. However, leveling up or a potion restores all health points.",'Each monster requires a number of hits to be defeated which is calculated as follows: <em>" monster health divided by hero strength "</em>','The damage of a monster is calculated according to the following formula: <em>" (number of hits to be defeated multiplied by the strength of the monster) minus the hero\'s shield "</em>',"Defeating a monster with a spell only grants 50% experience points but can prevent certain death or very large damage.","The fights take place automatically so be sure to choose your game action. Escape can be a good way to stay alive.","The shield stat is used to reduce damage when attacked in combat. It can only be increased by the spirit of the earth.","The Tower is populated by various spirits. Most of them will help you greatly on your quest, however some can be aggressive.","When you open a chest, you have a chance to stumble upon a monster that will deal damage to you that ignores your shield stat.","The Tower is divided by floors. Each floor itself is made up of 10 rooms. On each floor, the monsters become more powerful.",'For the more curious, the end-of-game score is calculated according to the following formula: <em>" ((shield + strength + maximum health) * level) * floor "</em>',"A fight against a powerful opponent is more complicated. You cannot flee and it is necessary to have at least 3 spells to win thanks to the spell.","At the start of the game, each item you can collect is limited to a certain quantity. Later, you can keep more."]};"fr"==navigator.language||"fr-FR"==navigator.language||"FR-fr"==navigator.language?(get("#htmlTag").lang="fr",language=FR):(get("#htmlTag").lang="en",language=EN);for(let e=0;e<Object.keys(language).length-4;e++){let t=language[Object.keys(language)[e]],a=Object.keys(t),s=Object.values(t);for(let e=0;e<a.length;e++)get("#"+a[e]).innerHTML=s[e]}function startGame(e){get("#startScreen").style.display="none",get("#gameScreen").style.display="flex",changeDisplay("classic"),displayGame(),settings.refreshDisplay=setInterval(displayGame,100),get("#optionButton").style.visibility="visible",get("#volumeButton").style.visibility="visible",get("#volumeButton").addEventListener("click",checkSound),1==game.core.sound?get("#volumeButton").innerHTML="🔊":get("#volumeButton").innerHTML="🔈",get("#optionButton").addEventListener("click",function(){get("#containerPopup").style.display="flex",get("#optionMenu").style.display="block",get("#closeOptionMenu").addEventListener("click",function(){get("#containerPopup").style.display="none",get("#optionMenu").style.display="none"})}),get("#openStatsMenu").addEventListener("click",function(){let e=Object.values(language.stats),t=Object.values(game.stats);for(let a=0;a<e.length;a++)0==a?get("#listStats").innerHTML="<li>"+e[a]+t[a]+"</li>":get("#listStats").innerHTML+="<li>"+e[a]+t[a]+"</li>";get("#optionMenu").style.display="none",get("#statsMenu").style.display="block",get("#closeStatsMenu").addEventListener("click",function(){get("#containerPopup").style.display="none",get("#statsMenu").style.display="none"})}),get("#openInfoMenu").addEventListener("click",function(){get("#optionMenu").style.display="none",get("#infoMenu").style.display="block",get("#closeInfoMenu").addEventListener("click",function(){get("#containerPopup").style.display="none",get("#infoMenu").style.display="none"})}),get("#confirmRestart").addEventListener("click",function(){clearInterval(settings.refreshDisplay),game.core.ongoing=!1,resetData(),location.reload()}),get("#confirmTotalRestart").addEventListener("click",function(){clearInterval(settings.refreshDisplay),storage("rem","TOWER-gameSettings"),location.reload()}),get("#move").addEventListener("click",play),get("#useHeal").addEventListener("click",heal),get("#openChest").addEventListener("click",openChest),get("#closeChest").addEventListener("click",closeChest),get("#useAttack").addEventListener("click",attack),get("#useMagic").addEventListener("click",magic),get("#useEscape").addEventListener("click",runAway),"new"==e&&(get("#gameContent").innerHTML=language.app.initialContent,game.core.name=get("#nameHero").value,1==game.core.sound&&get("#soundRoom").play()),"load"==e&&(get("#gameContent").innerHTML=game.events.currentEvent,"fight"==game.events.lastAction&&"fightOver"!=game.events.subAction&&changeDisplay("gameToFight"),"bossFight"==game.events.lastAction&&"fightOver"!=game.events.subAction&&changeDisplay("gameToBossFight"),"chest"==game.events.lastAction&&"chestOver"!=game.events.subAction&&changeDisplay("gameToChest"))}function play(){game.core.ongoing=!0,game.events.subAction=null,game.character.room++,changeDisplay("displayMessage"),game.character.room>10?(1==game.core.sound&&get("#soundFloor").play(),settings.messageDisplay=2e3,game.character.room=1,game.character.floor++,game.character.floor>game.stats.bestFloor&&(game.stats.bestFloor=game.character.floor),get("#gameMessage").innerHTML='<p class="bigger">'+language.app.floor+" "+game.character.floor+"</p>"):(1==game.core.sound&&get("#soundRoom").play(),settings.messageDisplay=1e3,game.stats.totalRoom++,get("#gameMessage").innerHTML='<p class="bigger">'+language.app.floor+" "+parseInt(game.character.floor)+"</p>",get("#gameMessage").innerHTML+="<p>"+language.app.room+" "+game.character.room+"</p>"),setTimeout(function(){changeDisplay("hideMessage")},settings.messageDisplay),8==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):11==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):14==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):17==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):20==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):23==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):26==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):29==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):32==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):35==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):38==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):41==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):43==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):46==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):49==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):52==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):55==game.character.floor&&10==game.character.room?specialEvt("evtBoss"):choiceAction()}function choiceAction(){let e=nbRandom(1,9);e>7?(game.events.newAction="spirit",game.events.newAction!=game.events.lastAction?spirit():choiceAction()):e>4?(game.events.newAction="fight",game.events.newAction!=game.events.lastAction?fight():choiceAction()):e>2?(game.events.newAction="chest",game.events.newAction!=game.events.lastAction?chest():choiceAction()):(game.events.newAction="noEvent",game.events.newAction!=game.events.lastAction?noEvent():choiceAction())}function specialEvt(e){game.events.lastAction="special","evtBoss"==e&&(1==game.core.sound&&get("#soundBossFight").play(),fight("bossFight")),saveContent()}function heal(){game.character.heal>0&&game.character.health<game.character.healthMax&&(1==game.core.sound&&get("#soundHeal").play(),game.character.heal--,game.character.health=game.character.healthMax,game.stats.healUsed++,get("#gameContent").innerHTML+='<hr><p class="green">'+language.app.healing+"</p>",saveContent())}function noEvent(){game.events.lastAction="noEvent",get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/noEvent.png" alt=""></div><p>'+language.app.noEvent+".</p>",saveContent()}function spirit(){game.events.lastAction="spirit";let e=nbRandom(1,10);if(e>8)game.stats.earthSpiritMeet++,game.character.shield=game.character.shield+settings.bonusSpirit.shield,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/spiritEarth.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.spiritEarth_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+language.app.spiritEarth_part2+" <strong>"+settings.bonusSpirit.shield+"</strong> "+singularPlural(settings.bonusSpirit.shield,language.app.point_singular,language.app.point_plural)+".</p>";else if(e>6){switch(game.stats.windSpiritMeet++,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/spiritWind.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.spiritWind+".</p>",nbRandom(1,3)){case 1:0!=game.character.heal?(game.character.heal--,get("#gameContent").innerHTML+='<p class="red">'+language.app.spiritWind_healStealing+".</p>"):get("#gameContent").innerHTML+="<p>"+language.app.spiritWind_noStealing+".</p>";break;case 2:0!=game.character.magic?(game.character.magic--,get("#gameContent").innerHTML+='<p class="red">'+language.app.spiritWind_magicStealing+".</p>"):get("#gameContent").innerHTML+="<p>"+language.app.spiritWind_noStealing+".</p>";break;case 3:0!=game.character.escape?(game.character.escape--,get("#gameContent").innerHTML+='<p class="red">'+language.app.spiritWind_escapeStealing+".</p>"):get("#gameContent").innerHTML+="<p>"+language.app.spiritWind_noStealing+".</p>"}}else if(e>4){game.stats.lighSpiritMeet++;let e=nbRandom(parseInt(game.character.xpTo/8),parseInt(game.character.xpTo/6));game.character.xp=game.character.xp+e,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/spiritLight.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.spiritLight_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+language.app.spiritLight_part2+"<strong>"+e+"</strong> "+singularPlural(e,language.app.point_singular,language.app.point_plural)+language.app.spiritLight_part3+".</p>"}else e>2?(game.stats.fireSpiritMeet++,game.character.strength=game.character.strength+settings.bonusSpirit.strength,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/spiritFire.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.spiritFire_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+language.app.spiritFire_part2+" <strong>"+settings.bonusSpirit.strength+"</strong> "+singularPlural(settings.bonusSpirit.strength,language.app.point_singular,language.app.point_plural)+".</p>"):(game.stats.waterSpiritMeet++,game.character.healthMax=game.character.healthMax+settings.bonusSpirit.health,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/spiritWater.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.spiritWater_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+language.app.spiritWater_part2+" <strong>"+settings.bonusSpirit.health+"</strong> "+singularPlural(settings.bonusSpirit.health,language.app.point_singular,language.app.point_plural)+".</p>");saveContent()}function chest(){game.events.lastAction="chest",changeDisplay("gameToChest"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/chest.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.chest+" !</p>",saveContent()}function openChest(){1==game.core.sound&&get("#soundChest").play(),game.events.subAction="chestOver",changeDisplay("chestToGame");let e=nbRandom(0,10);if(e>7){game.stats.chestTrap++;let e=nbRandom(1,game.character.health/4);game.character.health=game.character.health-e,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/chestTrap.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.chestTrap_part1+" !</p>",get("#gameContent").innerHTML+='<p class="red">'+language.app.chestTrap_part2+"<strong>"+e+"</strong> "+singularPlural(e,language.app.point_singular,language.app.point_plural)+language.app.chestTrap_part3+".</p>"}else e>5?(game.stats.escapeFound++,game.character.itemLimit>=game.character.escape&&game.character.escape++,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/chestEscape.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.chestEscape+".</p>",game.character.itemLimit==game.character.escape&&(get("#gameContent").innerHTML+="<p>"+language.app.chestLimit+".</p>")):e>3?(game.stats.magicFound++,game.character.itemLimit>=game.character.magic&&game.character.magic++,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/chestMagic.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.chestMagic+".</p>",game.character.itemLimit==game.character.magic&&(get("#gameContent").innerHTML+="<p>"+language.app.chestLimit+".</p>")):(game.stats.healFound++,game.character.itemLimit>=game.character.heal&&game.character.heal++,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/chestHeal.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.chestHeal+".</p>",game.character.itemLimit==game.character.heal&&(get("#gameContent").innerHTML+="<p>"+language.app.chestLimit+".</p>"));saveContent()}function closeChest(){game.stats.chestNotOpened++,game.events.subAction="chestOver",changeDisplay("chestToGame"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/events/chest.png" alt=""></div>',get("#gameContent").innerHTML+="<p>"+language.app.chest+" !</p>",get("#gameContent").innerHTML+="<p>"+language.app.chest_notOpened+".</p>",saveContent()}function fight(e){game.events.lastAction="bossFight"==e?"bossFight":"fight",game.events.monster=choiceMonster(),changeDisplay("bossFight"==e?"gameToBossFight":"gameToFight"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/monsters/'+game.events.monster[3]+'.png" alt="'+game.events.monster[2]+'"></div>',get("#gameContent").innerHTML+="bossFight"==e?"<p>"+language.app.bossFight_start+" !</p>":"<p><strong>"+game.events.monster[2]+"</strong> "+language.app.fightStart+"</p>",get("#gameContent").innerHTML+="<p>"+language.app.health+" : <strong>"+game.events.monster[0]+"</strong> / "+language.app.strength+" : <strong>"+game.events.monster[1]+"</strong></p>",saveContent()}function choiceMonster(){return"bossFight"==game.events.lastAction?monsterLevel=nbRandom(10*game.character.floor,15*game.character.floor):monsterLevel=nbRandom(2*game.character.floor,4*game.character.floor),monsterLevel>800?[monsterLevel,parseInt(monsterLevel/3),language.monsters.dragon,"monster_17"]:monsterLevel>600?[monsterLevel,parseInt(monsterLevel/3),language.monsters.supDemon,"monster_16"]:monsterLevel>450?[monsterLevel,parseInt(monsterLevel/3),language.monsters.bigSpirit,"monster_15"]:monsterLevel>350?[monsterLevel,parseInt(monsterLevel/3),language.monsters.deadWarrior,"monster_14"]:monsterLevel>300?[monsterLevel,parseInt(monsterLevel/3),language.monsters.troll,"monster_13"]:monsterLevel>250?[monsterLevel,parseInt(monsterLevel/3),language.monsters.behemot,"monster_12"]:monsterLevel>200?[monsterLevel,parseInt(monsterLevel/3),language.monsters.minotaur,"monster_11"]:monsterLevel>160?[monsterLevel,parseInt(monsterLevel/3),language.monsters.cerberus,"monster_10"]:monsterLevel>130?[monsterLevel,parseInt(monsterLevel/3),language.monsters.goblin,"monster_09"]:monsterLevel>100?[monsterLevel,parseInt(monsterLevel/3),language.monsters.ghost,"monster_08"]:monsterLevel>75?[monsterLevel,parseInt(monsterLevel/3),language.monsters.cockatrice,"monster_07"]:monsterLevel>50?[monsterLevel,parseInt(monsterLevel/3),language.monsters.lamia,"monster_06"]:monsterLevel>40?[monsterLevel,parseInt(monsterLevel/3),language.monsters.imp,"monster_05"]:monsterLevel>30?[monsterLevel,parseInt(monsterLevel/3),language.monsters.plant,"monster_04"]:monsterLevel>20?[monsterLevel,parseInt(monsterLevel/3),language.monsters.scorpio,"monster_03"]:monsterLevel>10?[monsterLevel,parseInt(monsterLevel/3),language.monsters.spider,"monster_02"]:[monsterLevel,parseInt(monsterLevel/3),language.monsters.slim,"monster_01"]}function attack(){1==game.core.sound&&get("#soundAttack").play(),game.stats.swordKill++,game.events.subAction="fightOver",changeDisplay("fightToGame");let e=Math.ceil(game.events.monster[0]/game.character.strength),t=parseInt(e*game.events.monster[1]-parseInt(game.events.monster[1])/e)-game.character.shield;1==e&&(t=0),t<0&&(t=0),game.character.health=game.character.health-t;let a=nbRandom(game.character.level*game.events.monster[0],game.character.level*game.events.monster[0]*2);"bossFight"==game.events.lastAction?game.character.xp=game.character.xp+5*a:game.character.xp=game.character.xp+a,game.stats.totalExp=game.stats.totalExp+a,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/monsters/'+game.events.monster[3]+'.png" alt="'+game.events.monster[2]+'"></div>',"bossFight"==game.events.lastAction?get("#gameContent").innerHTML+="<p>"+language.app.bossFightWin+"<strong>"+e+"</strong> "+singularPlural(e,language.app.hit_singular,language.app.hit_plural)+" !</p>":get("#gameContent").innerHTML+="<p><strong>"+game.events.monster[2]+"</strong> "+language.app.fightWin_part1+"<strong>"+e+"</strong> "+singularPlural(e,language.app.hit_singular,language.app.hit_plural)+" !</p>",get("#gameContent").innerHTML+='<p class="red">'+language.app.fightWin_part2+"<strong>"+t+"</strong> "+singularPlural(t,language.app.point_singular,language.app.point_plural)+" "+language.app.fightWin_part3+".</p>",game.character.health>0&&(get("#gameContent").innerHTML+='<p class="green">'+language.app.fightWin_part5+"<strong>"+a+"</strong> "+singularPlural(a,language.app.point_singular,language.app.point_plural)+language.app.fightWin_part4+".</p>"),saveContent()}function magic(){if("bossFight"!=game.events.lastAction&&game.character.magic>0||"bossFight"==game.events.lastAction&&game.character.magic>2){1==game.core.sound&&get("#soundMagic").play(),game.stats.magicKill++,game.events.subAction="fightOver",changeDisplay("fightToGame"),"bossFight"==game.events.lastAction?game.character.magic=game.character.magic-3:game.character.magic--;let e=nbRandom(parseInt(game.character.level*game.events.monster[0]/2),game.character.level*game.events.monster[0]);game.character.xp=game.character.xp+e,game.stats.totalExp=game.stats.totalExp+e,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/monsters/'+game.events.monster[3]+'.png"alt="'+game.events.monster[2]+'"></div>',"bossFight"==game.events.lastAction?get("#gameContent").innerHTML+="<p>"+language.app.bossFight_magic+".</p>":get("#gameContent").innerHTML+="<p>"+language.app.fightMagic+".</p>",get("#gameContent").innerHTML+='<p class="green">'+language.app.fightWin_part5+"<strong>"+e+"</strong> "+singularPlural(e,language.app.point_singular,language.app.point_plural)+language.app.fightWin_part4+".</p>",saveContent()}}function runAway(){game.character.escape>0&&(1==game.core.sound&&get("#soundEscape").play(),game.stats.runAway++,game.character.escape--,changeDisplay("fightToGame"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/monsters/'+game.events.monster[3]+'.png" alt="'+game.events.monster[2]+'"></div>',get("#gameContent").innerHTML+="<p>"+language.app.fightEscape+".</p>",saveContent())}function displayGame(){game.character.health<1?gameOver():(checkExperience(),checkItems(),checkScore(),get("#name").innerHTML='<img src="assets/images/icons/hero.png" alt="🤺"> '+game.core.name+" ("+language.app.level+" "+game.character.level+")",get("#health").innerHTML='<img src="assets/images/icons/health.png" alt="💓"> '+language.app.health+" "+game.character.health+" / "+game.character.healthMax,get("#xp").innerHTML='<img src="assets/images/icons/xp.png" alt="🏆"> '+language.app.experience+" "+game.character.xp+" / "+game.character.xpTo,get("#strength").innerHTML='<img src="assets/images/icons/strength.png" alt="💪">  '+language.app.strength+" "+game.character.strength,get("#shield").innerHTML='<img src="assets/images/icons/shield.png" alt="🛡️">  '+language.app.shield+" "+game.character.shield,get("#headerTitle").innerHTML=language.app.floor+" "+game.character.floor+" - "+language.app.room+" "+game.character.room,storage("set","TOWER-gameSettings",JSON.stringify(game)))}function gameOver(){clearInterval(settings.refreshDisplay),changeDisplay("classic"),get("#health").innerHTML='<img src="assets/images/icons/health.png" alt="💓"> '+language.app.health+" 0 / "+game.character.healthMax,get("#move").innerHTML=language.app.results,get("#move").removeEventListener("click",play),get("#move").addEventListener("click",displayScore),get("#useHeal").style.display="none",get("#gameContent").innerHTML+='<p class="red"><strong>'+language.app.death+"</strong></p>"}function displayScore(){if(resetData(),changeDisplay("displayMessage"),get("#gameMessage").style.backgroundColor="lightcoral",get("#gameMessage").innerHTML='<p class="bigger">'+language.app.gameover+game.character.score+" pts.</p>",get("#gameMessage").innerHTML+='<button id="restart">'+language.app.gameoverButton+"</button>",get("#restart").addEventListener("click",function(){location.reload()}),navigator.share){get("#gameMessage").innerHTML+='<button id="share">'+language.app.shareScore_button+"</button>";const e={text:language.app.shareScore_part1+game.character.score+language.app.shareScore_part2,url:"https://nicolas-deleforge/apps/tower/"};get("#share").addEventListener("click",function(){navigator.share(e)})}}function changeDisplay(e){"classic"==e&&(get(".listActionsLine")[1].style.display="none",get(".listActionsLine")[2].style.display="none"),"gameToChest"==e&&(get(".listActionsLine")[0].style.display="none",get(".listActionsLine")[1].style.display="flex"),"chestToGame"==e&&(get(".listActionsLine")[0].style.display="flex",get(".listActionsLine")[1].style.display="none"),"gameToFight"==e&&(get(".listActionsLine")[0].style.display="none",get(".listActionsLine")[2].style.display="flex"),"fightToGame"==e&&(get(".listActionsLine")[0].style.display="flex",get(".listActionsLine")[2].style.display="none"),"gameToBossFight"==e&&(get(".listActionsLine")[0].style.display="none",get(".listActionsLine")[2].style.display="flex"),"bossFightToGame"==e&&(get(".listActionsLine")[2].style.display="none",get(".listActionsLine")[0].style.display="flex"),"displayMessage"==e&&(get("~header").style.display="none",get("#gameScreen").style.display="none",get("#gameMessage").style.display="flex"),"hideMessage"==e&&(get("~header").style.display="flex",get("#gameScreen").style.display="flex",get("#gameMessage").style.display="none")}function checkItems(){game.character.heal<1||game.character.health==game.character.healthMax?get("#useHeal").disabled=!0:get("#useHeal").disabled=!1,"bossFight"!=game.events.lastAction&&game.character.magic>0||"bossFight"==game.events.lastAction&&game.character.magic>2?get("#useMagic").disabled=!1:get("#useMagic").disabled=!0,game.character.escape>0&&"bossFight"!=game.events.lastAction?get("#useEscape").disabled=!1:get("#useEscape").disabled=!0,get("#potion").innerHTML='<img src="assets/images/icons/potion.png" alt="🥃"> '+game.character.heal+" "+singularPlural(game.character.heal,language.app.heal_singular,language.app.heal_plural),get("#magic").innerHTML='<img src="assets/images/icons/magic.png" alt="🃏"> '+game.character.magic+" "+singularPlural(game.character.magic,language.app.magic_singular,language.app.magic_plural),get("#escape").innerHTML='<img src="assets/images/icons/escape.png" alt="📜"> '+game.character.escape+" "+singularPlural(game.character.escape,language.app.escape_singular,language.app.escape_plural)}function checkExperience(){game.character.xp>=game.character.xpTo&&(game.character.level++,game.character.strength=game.character.strength+game.bonus.lvlStrength,game.character.shield=game.character.shield+game.bonus.lvlShield,game.character.healthMax=game.character.healthMax+game.bonus.lvlHealth,game.character.health=game.character.healthMax,game.character.xp=0,game.character.xpTo=nbRandom(parseInt(1.5*game.character.xpTo),2*game.character.xpTo),game.character.level>game.stats.maxLevel&&(game.stats.maxLevel=game.character.level),get("#gameContent").innerHTML+='<hr><p class="green">'+language.app.levelUp_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+language.app.levelUp_part2+".</p>",game.events.currentEvent=get("#gameContent").innerHTML)}function checkScore(){game.character.score=(game.character.strength+game.character.healthMax)*game.character.level*game.character.floor-30,game.character.score>game.stats.bestScore&&(game.stats.bestScore=game.character.score)}function checkSound(){1==game.core.sound?(game.core.sound=!1,get("#volumeButton").innerHTML="🔈"):(game.core.sound=!0,get("#volumeButton").innerHTML="🔊")}function randomTip(){let e=nbRandom(0,language.tips.length);return language.tips[e]}function singularPlural(e,t,a){return e>1?a:t}function resetData(){game.core.ongoing=!1,game.stats.totalGame++,game.character.health=settings.basicStats.health,game.character.healthMax=settings.basicStats.healthMax,game.character.strength=settings.basicStats.strength,game.character.shield=settings.basicStats.shield,game.character.xp=settings.basicStats.xp,game.character.xpTo=settings.basicStats.xpTo,game.character.heal=settings.basicStats.heal,game.character.magic=settings.basicStats.magic,game.character.escape=settings.basicStats.escape,game.character.level=settings.basicStats.level,game.character.floor=settings.basicStats.floor,game.character.room=settings.basicStats.room,game.character.itemLimit=settings.basicStats.itemLimit,game.bonus.lvlHealth=settings.basicStats.bonusLvlHealth,game.bonus.lvlStrenght=settings.basicStats.bonusLvlStrenght,game.bonus.lvlShield=settings.basicStats.bonusLvlShield,storage("set","TOWER-gameSettings",JSON.stringify(game))}function saveContent(){game.events.currentEvent=get("#gameContent").innerHTML}function get(e){return 0==e.search("#")&&null!=e.split("#")[1]&&null!=document.querySelector(e)?document.querySelector(e):0==e.search(".")&&null!=e.split(".")[1]&&null!=document.querySelectorAll(e)?document.querySelectorAll(e):0==e.search("~")&&null!=e.split("~")[1]&&null!=document.querySelectorAll(e.split("~")[1])?document.querySelectorAll(e.split("~")[1])[0]:void 0}function storage(e,t,a){return"get"==e?localStorage.getItem(t):"set"==e?localStorage.setItem(t,a):"rem"==e?localStorage.removeItem(t):void 0}function nbRandom(e,t){return Math.floor(Math.random()*Math.floor(t))+e}0==game.core.ongoing?(get("#startScreen").style.display="flex",get("#displayTip").innerHTML=randomTip(),null!=game.core.name&&""!=game.core.name?get("#nameHero").value=game.core.name:(get("#nameHero").value="",get("#nameHero").focus()),get("#startGame").addEventListener("click",function(){get("#nameHero").checkValidity()&&""!=get("#nameHero").value?startGame("new"):(get("#nameHeroLabel").innerHTML=language.app.nameHeroCheck,get("#nameHeroLabel").style.color="red")})):startGame("load");