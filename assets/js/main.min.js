function launcher(){get("#startScreen").style.display="flex",get("#displayTip").innerHTML=_CONTENT.tips[rand(0,_CONTENT.tips.length)],null!=GAME.core.name&&""!=GAME.core.name?get("#nameHero").value=GAME.core.name:(get("#nameHero").value="",get("#nameHero").focus()),get("#startGame").addEventListener("click",function(){get("#nameHero").checkValidity()&&""!=get("#nameHero").value?startGame("new"):(get("#nameHeroLabel").innerHTML=_CONTENT.app.nameHeroCheck,get("#nameHeroLabel").style.color=getVariableCSS("--errorTextColor"))})}function startGame(e){get("#startScreen").style.display="none",get("#gameScreen").style.display="flex",changeDisplay("actionGameMode"),createMenu(),createButtons(),REFRESH_DISPLAY=setInterval(displayGame,100),"new"==e?(GAME.core.name=get("#nameHero").value,GAME.core.ongoing=!0,playSound("sound","Room"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.start+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.startGame_part1+".</p>",get("#gameContent").innerHTML+="<em>"+_CONTENT.app.startGame_part2+".</em>",get("#gameContent").innerHTML+="<p>"+_CONTENT.app.startGame_part3+".</p>"):"load"==e&&("fight"==GAME.events.lastAction&&"fightOver"!=GAME.events.subAction&&changeDisplay("actionGameToFight"),"chest"==GAME.events.lastAction&&"chestOver"!=GAME.events.subAction&&changeDisplay("actionGameToChest"),get("#gameContent").innerHTML=GAME.events.currentEvent)}function playTurn(){GAME.events.subAction=null,GAME.character.room++,changeDisplay("screenDisplayMessage"),GAME.character.room>10?(INTERVAL_REFRESH=2e3,GAME.character.room=1,GAME.character.floor++,playSound("sound","Floor"),get("#gameMessage").innerHTML='<p class="bigger">'+_CONTENT.app.floor+" "+GAME.character.floor+"</p>"):(INTERVAL_REFRESH=1e3,GAME.stats.totalRoom++,playSound("sound","Room"),get("#gameMessage").innerHTML='<p class="bigger">'+_CONTENT.app.floor+" "+parseInt(GAME.character.floor)+"</p>",get("#gameMessage").innerHTML+="<p>"+_CONTENT.app.room+" "+GAME.character.room+"</p>"),setTimeout(function(){changeDisplay("screenHideMessage")},INTERVAL_REFRESH),choiceAction()}function choiceAction(){let e=rand(1,9);e>7?(GAME.events.newAction="spirit",GAME.events.newAction!=GAME.events.lastAction?spirit():choiceAction()):e>4?(GAME.events.newAction="fight",GAME.events.newAction!=GAME.events.lastAction?fight():choiceAction()):e>2?(GAME.events.newAction="chest",GAME.events.newAction!=GAME.events.lastAction?chest():choiceAction()):(GAME.events.newAction="noEvent",GAME.events.newAction!=GAME.events.lastAction?noEvent():choiceAction())}function heal(){GAME.character.itemHeal>0&&GAME.character.health<GAME.character.healthMax?(GAME.character.itemHeal--,GAME.character.health=GAME.character.healthMax,GAME.stats.healUsed++,playSound("vibrate",10),playSound("sound","Heal"),get("#gameContent").innerHTML+='<hr><p class="green">'+_CONTENT.app.healing+"</p>"):playSound("vibrate",250)}function noEvent(){GAME.events.lastAction="noEvent",get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.noEvent+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.noEvent+".</p>"}function spirit(){GAME.events.lastAction="spirit",GAME.stats.spiritMeet++;let e=rand(1,8);if(e>6)GAME.character.shield=GAME.character.shield+_SETTINGS.data.spiritShield,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.earthSpirit+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.spiritEarth_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.app.spiritEarth_part2+" <strong>"+_SETTINGS.data.spiritShield+"</strong> "+plural(_SETTINGS.data.spiritShield,_CONTENT.app.point_singular,_CONTENT.app.point_plural)+".</p>";else if(e>4){let e=rand(parseInt(GAME.character.xpTo/8),parseInt(GAME.character.xpTo/6));GAME.character.xp=GAME.character.xp+e,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.lightSpirit+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.spiritLight_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.app.spiritLight_part2+"<strong>"+e+"</strong> "+plural(e,_CONTENT.app.point_singular,_CONTENT.app.point_plural)+_CONTENT.app.spiritLight_part3+".</p>"}else e>2?(GAME.character.strength=GAME.character.strength+_SETTINGS.data.spiritStrength,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.fireSpirit+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.spiritFire_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.app.spiritFire_part2+" <strong>"+_SETTINGS.data.spiritStrength+"</strong> "+plural(_SETTINGS.data.spiritStrength,_CONTENT.app.point_singular,_CONTENT.app.point_plural)+".</p>"):(GAME.character.healthMax=GAME.character.healthMax+_SETTINGS.data.spiritHealth,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.waterSpirit+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.spiritWater_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.app.spiritWater_part2+" <strong>"+_SETTINGS.data.spiritHealth+"</strong> "+plural(_SETTINGS.data.spiritHealth,_CONTENT.app.point_singular,_CONTENT.app.point_plural)+".</p>")}function chest(){GAME.events.lastAction="chest",changeDisplay("actionGameToChest"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chest+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chest+" !</p>"}function openChest(){GAME.events.subAction="chestOver",GAME.stats.chestOpen++,playSound("vibrate",90),playSound("sound","Chest"),changeDisplay("actionChestToGame");let e=rand(0,10),t=!1;if(e>7){GAME.stats.chestTrap++;let e=rand(1,GAME.character.health/4);GAME.character.health=GAME.character.health-e,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chestTrap+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chestTrap_part1+" !</p>",get("#gameContent").innerHTML+='<p class="red">'+_CONTENT.app.chestTrap_part2+"<strong>"+e+"</strong> "+plural(e,_CONTENT.app.point_singular,_CONTENT.app.point_plural)+_CONTENT.app.chestTrap_part3+".</p>"}else e>5?(_SETTINGS.data.itemLimit>GAME.character.itemEscape?GAME.character.itemEscape++:t=!0,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chestEscape+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chestEscape+".</p>",t&&(get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chestLimit+".</p>")):e>3?(_SETTINGS.data.itemLimit>GAME.character.itemMagic?GAME.character.itemMagic++:t=!0,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chestMagic+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chestMagic+".</p>",t&&(get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chestLimit+".</p>")):(_SETTINGS.data.itemLimit>GAME.character.itemHeal?GAME.character.itemHeal++:t=!0,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chestHeal+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chestHeal+".</p>",t&&(get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chestLimit+".</p>"))}function closeChest(){GAME.events.subAction="chestOver",GAME.stats.chestNotOpened++,playSound("vibrate",10),changeDisplay("actionChestToGame"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+_SETTINGS.images.chest+'" alt=""></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chest+" !</p>",get("#gameContent").innerHTML+="<p>"+_CONTENT.app.chest_notOpened+".</p>"}function fight(){GAME.events.lastAction="fight",GAME.events.monster=choiceMonster(),changeDisplay("actionGameToFight"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+GAME.events.monster[3]+'" alt="'+GAME.events.monster[2]+'"></div>',get("#gameContent").innerHTML+="<p><strong>"+GAME.events.monster[2]+"</strong> "+_CONTENT.app.fightStart+"</p>",get("#gameContent").innerHTML+="<p>"+_CONTENT.app.health+" : <strong>"+GAME.events.monster[0]+"</strong> / "+_CONTENT.app.strength+" : <strong>"+GAME.events.monster[1]+"</strong></p>"}function choiceMonster(){let e=rand(2*GAME.character.floor,4*GAME.character.floor);return e>500?[e,parseInt(e/3),_CONTENT.monsters.dragon,_SETTINGS.images.monster17]:e>450?[e,parseInt(e/3),_CONTENT.monsters.supDemon,_SETTINGS.images.monster16]:e>400?[e,parseInt(e/3),_CONTENT.monsters.bigSpirit,_SETTINGS.images.monster15]:e>350?[e,parseInt(e/3),_CONTENT.monsters.deadWarrior,_SETTINGS.images.monster14]:e>290?[e,parseInt(e/3),_CONTENT.monsters.troll,_SETTINGS.images.monster13]:e>240?[e,parseInt(e/3),_CONTENT.monsters.behemot,_SETTINGS.images.monster12]:e>190?[e,parseInt(e/3),_CONTENT.monsters.minotaur,_SETTINGS.images.monster11]:e>160?[e,parseInt(e/3),_CONTENT.monsters.cerberus,_SETTINGS.images.monster10]:e>130?[e,parseInt(e/3),_CONTENT.monsters.goblin,_SETTINGS.images.monster09]:e>100?[e,parseInt(e/3),_CONTENT.monsters.ghost,_SETTINGS.images.monster08]:e>75?[e,parseInt(e/3),_CONTENT.monsters.cockatrice,_SETTINGS.images.monster07]:e>50?[e,parseInt(e/3),_CONTENT.monsters.lamia,_SETTINGS.images.monster06]:e>40?[e,parseInt(e/3),_CONTENT.monsters.imp,_SETTINGS.images.monster05]:e>30?[e,parseInt(e/3),_CONTENT.monsters.plant,_SETTINGS.images.monster04]:e>20?[e,parseInt(e/3),_CONTENT.monsters.scorpio,_SETTINGS.images.monster03]:e>10?[e,parseInt(e/3),_CONTENT.monsters.spider,_SETTINGS.images.monster02]:[e,parseInt(e/3),_CONTENT.monsters.slim,_SETTINGS.images.monster01]}function attack(){GAME.events.subAction="fightOver",GAME.stats.fightVictory++,playSound("vibrate",10),playSound("sound","Attack"),changeDisplay("actionFightToGame");let e=Math.ceil(GAME.events.monster[0]/GAME.character.strength),t=parseInt(e*GAME.events.monster[1]-parseInt(GAME.events.monster[1])/e)-GAME.character.shield;1==e&&(t=0),t<0&&(t=0),GAME.character.health=GAME.character.health-t;let a=rand(GAME.character.level*GAME.events.monster[0],GAME.character.level*GAME.events.monster[0]*2);GAME.character.xp=GAME.character.xp+a,GAME.stats.totalExp=GAME.stats.totalExp+a,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+GAME.events.monster[3]+'" alt="'+GAME.events.monster[2]+'"></div>',get("#gameContent").innerHTML+="<p><strong>"+GAME.events.monster[2]+"</strong> "+_CONTENT.app.fightWin_part1+"<strong>"+e+"</strong> "+plural(e,_CONTENT.app.hit_singular,_CONTENT.app.hit_plural)+" !</p>",get("#gameContent").innerHTML+='<p class="red">'+_CONTENT.app.fightWin_part2+"<strong>"+t+"</strong> "+plural(t,_CONTENT.app.point_singular,_CONTENT.app.point_plural)+" "+_CONTENT.app.fightWin_part3+".</p>",GAME.character.health>0&&(get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.app.fightWin_part5+"<strong>"+a+"</strong> "+plural(a,_CONTENT.app.point_singular,_CONTENT.app.point_plural)+_CONTENT.app.fightWin_part4+".</p>")}function magic(){if(GAME.character.itemMagic>0){GAME.events.subAction="fightOver",GAME.character.itemMagic--,GAME.stats.fightVictory++,playSound("vibrate",10),playSound("sound","Magic"),changeDisplay("actionFightToGame");let e=rand(parseInt(GAME.character.level*GAME.events.monster[0]/2),GAME.character.level*GAME.events.monster[0]);GAME.character.xp=GAME.character.xp+e,GAME.stats.totalExp=GAME.stats.totalExp+e,get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+GAME.events.monster[3]+'" alt="'+GAME.events.monster[2]+'"></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.fightMagic+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.app.fightWin_part5+"<strong>"+e+"</strong> "+plural(e,_CONTENT.app.point_singular,_CONTENT.app.point_plural)+_CONTENT.app.fightWin_part4+".</p>"}else playSound("vibrate",250)}function runAway(){GAME.character.itemEscape>0?(GAME.character.itemEscape--,GAME.stats.fightEscape++,playSound("vibrate",10),playSound("sound","sound","Escape"),changeDisplay("actionFightToGame"),get("#gameContent").innerHTML='<div id="containerImage"><img src="assets/images/'+GAME.events.monster[3]+'" alt="'+GAME.events.monster[2]+'"></div>',get("#gameContent").innerHTML+="<p>"+_CONTENT.app.fightEscape+".</p>"):playSound("vibrate",250)}function displayGame(){GAME.character.health<1?gameOver():(checkExperience(),checkInfo(),checkItems(),checkScore(),""!=get("#gameContent").innerHTML&&(GAME.events.currentEvent=get("#gameContent").innerHTML),storage("set","TOWER-save",JSON.stringify(GAME)))}function gameOver(){clearInterval(REFRESH_DISPLAY),playSound("vibrate",500),changeDisplay("buttonGameMode"),get("#move").removeEventListener("click",playTurn),get("#move").addEventListener("click",displayScore),get("#move").innerHTML=_CONTENT.app.results,get("#useHeal").style.display="none",get("#gameContent").innerHTML+='<p class="red"><strong>'+_CONTENT.app.death+"</strong></p>"}function displayScore(){resetData(),changeDisplay("screenDisplayMessage"),get("#gameMessage").style.backgroundColor=getVariableCSS("--gameoverBackground"),get("#gameMessage").innerHTML='<p class="bigger">'+_CONTENT.app.gameover+GAME.character.score+" pts.</p>",get("#gameMessage").innerHTML+='<button id="restart">'+_CONTENT.app.gameoverButton+"</button>",get("#restart").addEventListener("click",function(){location.reload()})}function changeDisplay(e){"actionGameMode"==e&&(get(".listActionsLine")[1].style.display="none",get(".listActionsLine")[2].style.display="none"),"actionGameToChest"==e&&(get(".listActionsLine")[0].style.display="none",get(".listActionsLine")[1].style.display="flex"),"actionChestToGame"==e&&(get(".listActionsLine")[0].style.display="flex",get(".listActionsLine")[1].style.display="none"),"actionGameToFight"==e&&(get(".listActionsLine")[0].style.display="none",get(".listActionsLine")[2].style.display="flex"),"actionFightToGame"==e&&(get(".listActionsLine")[0].style.display="flex",get(".listActionsLine")[2].style.display="none"),"screenDisplayMessage"==e&&(get("~header").style.display="none",get("#gameScreen").style.display="none",get("#gameMessage").style.display="flex"),"screenHideMessage"==e&&(get("~header").style.display="flex",get("#gameScreen").style.display="flex",get("#gameMessage").style.display="none")}function checkInfo(){get("#headerTitle").innerHTML=_CONTENT.app.floor+" "+GAME.character.floor+" - "+_CONTENT.app.room+" "+GAME.character.room,get("#name").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconHero+'" alt=""> '+GAME.core.name+" ("+_CONTENT.app.level+" "+GAME.character.level+")",get("#health").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconHealth+'" alt=""> '+_CONTENT.app.health+" "+GAME.character.health+" / "+GAME.character.healthMax,get("#xp").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconExperience+'" alt=""> '+_CONTENT.app.experience+" "+GAME.character.xp+" / "+GAME.character.xpTo,get("#strength").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconStrength+'" alt="">  '+_CONTENT.app.strength+" "+GAME.character.strength,get("#shield").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconShield+'" alt="">  '+_CONTENT.app.shield+" "+GAME.character.shield}function checkItems(){get("#useHeal").style.opacity=GAME.character.itemHeal<1||GAME.character.health==GAME.character.healthMax?.5:1,get("#useMagic").style.opacity=GAME.character.itemMagic>0?1:.5,get("#useEscape").style.opacity=GAME.character.itemEscape>0?1:.5,get("#potion").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconPotion+'" alt=""> '+GAME.character.itemHeal+" "+plural(GAME.character.itemHeal,_CONTENT.app.heal_singular,_CONTENT.app.heal_plural),get("#magic").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconMagic+'" alt=""> '+GAME.character.itemMagic+" "+plural(GAME.character.itemMagic,_CONTENT.app.magic_singular,_CONTENT.app.magic_plural),get("#escape").innerHTML='<img src="assets/images/'+_SETTINGS.images.iconEscape+'"alt=""> '+GAME.character.itemEscape+" "+plural(GAME.character.itemEscape,_CONTENT.app.escape_singular,_CONTENT.app.escape_plural)}function checkExperience(){GAME.character.xp>=GAME.character.xpTo&&(GAME.character.level++,GAME.character.strength=GAME.character.strength+_SETTINGS.data.lvlUpStrength,GAME.character.shield=GAME.character.shield+_SETTINGS.data.lvlUpShield,GAME.character.healthMax=GAME.character.healthMax+_SETTINGS.data.lvlUpHealth,GAME.character.health=GAME.character.healthMax,GAME.character.xp=0,GAME.character.xpTo=rand(parseInt(1.5*GAME.character.xpTo),2*GAME.character.xpTo),get("#gameContent").innerHTML+='<hr><p class="green">'+_CONTENT.app.levelUp_part1+".</p>",get("#gameContent").innerHTML+='<p class="green">'+_CONTENT.app.levelUp_part2+".</p>")}function checkScore(){GAME.character.score=(GAME.character.strength+GAME.character.healthMax)*GAME.character.level*GAME.character.floor-30,GAME.character.score>GAME.stats.bestScore&&(GAME.stats.bestScore=GAME.character.score),GAME.character.floor>GAME.stats.bestFloor&&(GAME.stats.bestFloor=GAME.character.floor),GAME.character.level>GAME.stats.maxLevel&&(GAME.stats.maxLevel=GAME.character.level)}function checkSound(){1==GAME.core.sound?(GAME.core.sound=!1,get("#volumeButton").innerHTML="🔈"):(GAME.core.sound=!0,get("#volumeButton").innerHTML="🔊")}function checkVibrate(){1==GAME.core.vibrate?(GAME.core.vibrate=!1,get("#vibrateButton").innerHTML="📴"):(GAME.core.vibrate=!0,get("#vibrateButton").innerHTML="📳")}function checkStats(){let e=Object.values(_CONTENT.stats),t=Object.values(GAME.stats);for(let a=0;a<e.length;a++)0==a?get("#listStats").innerHTML="<li>"+e[a]+t[a]+"</li>":get("#listStats").innerHTML+="<li>"+e[a]+t[a]+"</li>"}function createMenu(){get("#openMenu").addEventListener("click",function(){get("#blankPage").style.display="block",get("#menu").style.display="block",get("#closeMenu").style.visibility="visible",checkStats()}),get("#closeMenu").addEventListener("click",function(){get("#blankPage").style.display="none",get("#menu").style.display="none",get("#closeMenu").style.visibility="hidden"}),get("#confirmRestart").addEventListener("click",function(){confirm(_CONTENT.app.confirmRestart)&&(clearInterval(REFRESH_DISPLAY),GAME.core.ongoing=!1,resetGame(),location.reload())}),get("#confirmTotalRestart").addEventListener("click",function(){confirm(_CONTENT.app.confirmDelete)&&(clearInterval(REFRESH_DISPLAY),storage("rem","TOWER-save"),location.reload())})}function createButtons(){get("#openMenu").style.visibility="visible",get("#volumeButton").addEventListener("click",checkSound),get("#vibrateButton").addEventListener("click",checkVibrate),1==GAME.core.sound?get("#volumeButton").innerHTML="🔊":get("#volumeButton").innerHTML="🔈",1==GAME.core.vibrate?get("#vibrateButton").innerHTML="📳":get("#vibrateButton").innerHTML="📴",get("#useHeal").addEventListener("click",heal),get("#openChest").addEventListener("click",openChest),get("#closeChest").addEventListener("click",closeChest),get("#useAttack").addEventListener("click",attack),get("#useMagic").addEventListener("click",magic),get("#useEscape").addEventListener("click",runAway),get("#move").addEventListener("click",function(){playSound("vibrate",50),playTurn()})}function playSound(e,t){"sound"==e&&1==GAME.core.sound&&get("#sound"+t).play(),"vibrate"==e&&1==GAME.core.vibrate&&navigator.vibrate(t)}function resetGame(){GAME.core.ongoing=!1,GAME.stats.totalGame++,GAME.character.health=_SETTINGS.data.health,GAME.character.healthMax=_SETTINGS.data.healthMax,GAME.character.strength=_SETTINGS.data.strength,GAME.character.shield=_SETTINGS.data.shield,GAME.character.xp=_SETTINGS.data.xp,GAME.character.xpTo=_SETTINGS.data.xpTo,GAME.character.itemHeal=_SETTINGS.data.itemHeal,GAME.character.itemMagic=_SETTINGS.data.itemMagic,GAME.character.itemEscape=_SETTINGS.data.itemEscape,GAME.character.level=_SETTINGS.data.level,GAME.character.floor=_SETTINGS.data.floor,GAME.character.room=_SETTINGS.data.room,storage("set","TOWER-save",JSON.stringify(GAME))}0==GAME.core.ongoing?launcher():startGame("load");